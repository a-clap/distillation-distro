From 17f510383957fe3eb381687da394e10c6b8d9c09 Mon Sep 17 00:00:00 2001
From: OpenEmbedded <oe.patch@oe>
Date: Fri, 3 Feb 2023 19:23:59 +0100
Subject: [PATCH] Add onewire buses on PA7, PA8

---
 .../dts/sun8i-h2-plus-bananapi-m2-zero.dts    | 38 +++++++++++++++++--
 1 file changed, 35 insertions(+), 3 deletions(-)

diff --git a/arch/arm/boot/dts/sun8i-h2-plus-bananapi-m2-zero.dts b/arch/arm/boot/dts/sun8i-h2-plus-bananapi-m2-zero.dts
index 73961fdc3fbb8..17aa052899811 100644
--- a/arch/arm/boot/dts/sun8i-h2-plus-bananapi-m2-zero.dts
+++ b/arch/arm/boot/dts/sun8i-h2-plus-bananapi-m2-zero.dts
@@ -110,16 +110,38 @@ wifi_pwrseq: wifi_pwrseq {
 		clock-names = "ext_clock";
 	};
 
-	onewire {
+	onewire_1 {
 		status = "okay";
 
 		compatible = "w1-gpio";
 
 		pinctrl-names = "default";
-		pinctrl-0 = <&onewire_pin>;
+		pinctrl-0 = <&onewire_pin_1>;
 		gpios = <&pio 2 7 GPIO_OPEN_DRAIN>;
 		linux,open-drain;
 	};
+
+	onewire_2 {
+		status = "okay";
+
+		compatible = "w1-gpio";
+
+		pinctrl-names = "default";
+		pinctrl-0 = <&onewire_pin_2>;
+		gpios = <&pio 0 7 GPIO_OPEN_DRAIN>;
+		linux,open-drain;
+	};
+
+	onewire_3 {
+		status = "okay";
+
+		compatible = "w1-gpio";
+
+		pinctrl-names = "default";
+		pinctrl-0 = <&onewire_pin_3>;
+		gpios = <&pio 0 8 GPIO_OPEN_DRAIN>;
+		linux,open-drain;
+	};
 };
 
 &cpu0 {
@@ -309,10 +331,20 @@ spidev@1 {
 };
 
 &pio {
-	onewire_pin: onewire-pin {
+	onewire_pin_1: onewire-pin-1 {
 		pins = "PC7";
 		function = "gpio_in";
 	};
+
+	onewire_pin_2: onewire-pin-2 {
+		pins = "PA7";
+		function = "gpio_in";
+	};
+
+	onewire_pin_3: onewire-pin-3 {
+		pins = "PA8";
+		function = "gpio_in";
+	};
 };
 
 &spi1 {
-- 
2.25.1

