From db2d99a68fbb1fd09c575e1a844031b0ed3bbcff Mon Sep 17 00:00:00 2001
From: OpenEmbedded <oe.patch@oe>
Date: Sat, 8 Oct 2022 20:56:29 +0200
Subject: [PATCH] Onewire on PI19

---
 arch/arm/boot/dts/sun7i-a20-bananapi.dts | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)

diff --git a/arch/arm/boot/dts/sun7i-a20-bananapi.dts b/arch/arm/boot/dts/sun7i-a20-bananapi.dts
index 46ecf9db2324..02b5ca45c9f0 100644
--- a/arch/arm/boot/dts/sun7i-a20-bananapi.dts
+++ b/arch/arm/boot/dts/sun7i-a20-bananapi.dts
@@ -82,6 +82,15 @@ led {
 			gpios = <&pio 7 24 GPIO_ACTIVE_HIGH>;
 		};
 	};
+	onewire {
+		status = "okay";
+
+		compatible = "w1-gpio";
+		pinctrl-names = "default";
+		pinctrl-0 = <&onewire_pins>;
+		gpios = <&pio 8 19 GPIO_OPEN_DRAIN>;
+		linux,open-drain;
+	};
 
 	reg_gmac_3v3: gmac-3v3 {
 		compatible = "regulator-fixed";
@@ -331,3 +340,10 @@ &usbphy {
 	usb2_vbus-supply = <&reg_usb2_vbus>;
 	status = "okay";
 };
+
+&pio {
+	onewire_pins: onewire-pins {
+		pins = "PI19";
+		function = "gpio_in";
+	};
+};
\ No newline at end of file
